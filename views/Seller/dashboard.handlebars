<!-- Dashboard Page - Buyer & Seller -->
<div class="row mb-4">
  <div class="col-12">
    <h3 class="mb-0"><i class="bi bi-speedometer2 me-2 text-primary"></i>Dashboard</h3>
    <p class="text-muted">Hello, {{user.full_name}}</p>
  </div>
</div>

<!-- Role Tabs -->
<ul class="nav nav-tabs mb-4" id="dashboardTabs" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="buyer-tab" data-bs-toggle="tab" data-bs-target="#buyer-panel" type="button" role="tab">
      <i class="bi bi-cart3 me-2"></i>Buyer Dashboard
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="seller-tab" data-bs-toggle="tab" data-bs-target="#seller-panel" type="button" role="tab">
      <i class="bi bi-shop me-2"></i>Seller Dashboard
    </button>
  </li>
</ul>

<div class="tab-content" id="dashboardTabContent">
  <!-- BUYER PANEL -->
  <div class="tab-pane fade show active" id="buyer-panel" role="tabpanel">
    <div class="row">
      <!-- Left Column: Buyer Activities -->
      <div class="col-lg-8">
        <!-- Active Bids -->
        <div class="card shadow-sm mb-4 border-0">
          <div class="card-header text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <h6 class="mb-0"><i class="bi bi-hammer me-2"></i>Active Bids</h6>
          </div>
          <div class="card-body p-0">
            <div class="list-group list-group-flush">
              {{#each activeBids}}
              <a href="/auctions/{{this.id}}" class="list-group-item list-group-item-action d-flex align-items-center border-0 border-bottom">
                <img src="{{this.image}}" class="rounded me-3 shadow-sm" style="width:70px; height:70px; object-fit:cover;">
                <div class="flex-grow-1">
                  <div class="fw-bold text-dark">{{this.title}}</div>
                  <div class="small mt-1">
                    <span class="text-muted">Your bid:</span> <span class="text-primary fw-bold">{{this.yourBid}}</span>
                    <span class="text-muted mx-1">–</span>
                    <span class="text-muted">Current:</span> <span class="text-success fw-bold">{{this.currentBid}}</span>
                  </div>
                </div>
                <i class="bi bi-chevron-right text-muted"></i>
              </a>
              {{else}}
              <div class="list-group-item text-center text-muted py-4 border-0">
                <i class="bi bi-inbox fs-3 d-block mb-2 opacity-50"></i>
                <small>No active bids</small>
              </div>
              {{/each}}
            </div>
          </div>
        </div>

        <!-- Won Auctions -->
        <div class="card shadow-sm mb-4 border-0">
          <div class="card-header text-white" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
            <h6 class="mb-0"><i class="bi bi-trophy me-2"></i>Won Auctions</h6>
          </div>
          <div class="card-body p-0">
            <div class="list-group list-group-flush">
              {{#each wonAuctions}}
              <a href="/orders/{{this.orderId}}" class="list-group-item list-group-item-action d-flex align-items-center border-0 border-bottom">
                <img src="{{this.image}}" class="rounded me-3 shadow-sm" style="width:50px; height:50px; object-fit:cover;">
                <div class="flex-grow-1">
                  <div class="fw-bold small text-dark">{{this.title}}</div>
                  <div class="text-success fw-bold small mt-1">{{this.winningBid}} VND</div>
                  {{#if this.isPaid}}
                  <span class="badge bg-success mt-1">Paid</span>
                  {{else}}
                  <span class="badge bg-warning mt-1">Pending</span>
                  {{/if}}
                </div>
                <i class="bi bi-chevron-right text-muted"></i>
              </a>
              {{else}}
              <div class="list-group-item text-center text-muted py-4 border-0">
                <i class="bi bi-trophy fs-3 d-block mb-2 opacity-50"></i>
                <small>No won auctions yet</small>
              </div>
              {{/each}}
            </div>
          </div>
        </div>

        <!-- Watchlist -->
        <div class="card shadow-sm mb-4 border-0">
          <div class="card-header text-white" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <h6 class="mb-0"><i class="bi bi-heart-fill me-2"></i>Watchlist</h6>
          </div>
          <div class="card-body p-0">
            <div class="list-group list-group-flush">
              {{#each watchlist}}
              <a href="/auctions/{{this.id}}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center small border-0 border-bottom">
                <span class="text-dark">{{this.title}}</span>
                <div class="d-flex align-items-center">
                  <span class="text-success fw-bold me-2">{{this.currentBid}}</span>
                  <i class="bi bi-chevron-right text-muted"></i>
                </div>
              </a>
              {{else}}
              <div class="list-group-item text-center text-muted py-4 border-0">
                <i class="bi bi-heart fs-3 d-block mb-2 opacity-50"></i>
                <small>No favorite items</small>
              </div>
              {{/each}}
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column: Buyer Statistics -->
      <div class="col-lg-4">
        <div class="row mb-3">
          <div class="col-6 mb-3">
            <div class="card text-center shadow-sm h-100 border-0 text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
              <div class="card-body p-3">
                <i class="bi bi-hammer fs-3 mb-2 opacity-75"></i>
                <div class="small text-white-50 mb-1">Active</div>
                <h4 class="mb-0 fw-bold">{{buyerStats.activeBids}}</h4>
              </div>
            </div>
          </div>
          <div class="col-6 mb-3">
            <div class="card text-center shadow-sm h-100 border-0 text-white" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
              <div class="card-body p-3">
                <i class="bi bi-trophy fs-3 mb-2 opacity-75"></i>
                <div class="small text-white-50 mb-1">Won</div>
                <h4 class="mb-0 fw-bold">{{buyerStats.wonAuctions}}</h4>
              </div>
            </div>
          </div>
          <div class="col-6 mb-3">
            <div class="card text-center shadow-sm h-100 border-0 text-white" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
              <div class="card-body p-3">
                <i class="bi bi-heart-fill fs-3 mb-2 opacity-75"></i>
                <div class="small text-white-50 mb-1">Favorites</div>
                <h4 class="mb-0 fw-bold">{{buyerStats.watchlist}}</h4>
              </div>
            </div>
          </div>
          <div class="col-6 mb-3">
            <div class="card text-center shadow-sm h-100 border-0 text-white" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
              <div class="card-body p-3">
                <i class="bi bi-wallet2 fs-3 mb-2 opacity-75"></i>
                <div class="small text-white-50 mb-1">Total Spent</div>
                <h4 class="mb-0 fw-bold">{{buyerStats.totalSpent}}</h4>
                <small class="text-white-50">million</small>
              </div>
            </div>
          </div>
        </div>

        <div class="card shadow-sm border-0">
          <div class="card-header text-white" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
            <h6 class="mb-0"><i class="bi bi-lightning-fill me-2"></i>Quick Actions</h6>
          </div>
          <div class="card-body">
            <a href="/products" class="btn btn-outline-primary w-100 mb-2">
              <i class="bi bi-search me-2"></i>Browse Auctions
            </a>
            <a href="/accounts/profile" class="btn btn-outline-secondary w-100">
              <i class="bi bi-person me-2"></i>My Profile
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SELLER PANEL -->
  <div class="tab-pane fade" id="seller-panel" role="tabpanel">
    <div class="row">
      <!-- Left Column: Seller Activities -->
      <div class="col-lg-8">
        <!-- Quick Action: Create Auction -->
        <div class="card shadow-sm mb-4 border-0" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
          <div class="card-body text-white text-center py-4">
            <i class="bi bi-plus-circle fs-1 mb-3 d-block"></i>
            <h5 class="mb-2">Create New Auction</h5>
            <p class="mb-3 opacity-75">List a new product for auction</p>
            <a href="/seller/create_product" class="btn btn-light btn-lg">
              <i class="bi bi-plus-lg me-2"></i>Create Auction
            </a>
          </div>
        </div>

        <!-- Active Auctions -->
        <div class="card shadow-sm mb-4 border-0">
          <div class="card-header text-white" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <h6 class="mb-0"><i class="bi bi-clock-history me-2"></i>Active Auctions</h6>
          </div>
          <div class="card-body p-0">
            <div class="list-group list-group-flush">
              {{#each sellerActiveAuctions}}
              <a href="/seller/auctions/{{this.id}}" class="list-group-item list-group-item-action d-flex align-items-center border-0 border-bottom">
                <img src="{{this.image}}" class="rounded me-3 shadow-sm" style="width:70px; height:70px; object-fit:cover;">
                <div class="flex-grow-1">
                  <div class="fw-bold text-dark">{{this.title}}</div>
                  <div class="small mt-1">
                    <span class="text-muted">Current bid:</span> <span class="text-success fw-bold">{{this.currentBid}}</span>
                    <span class="text-muted mx-1">•</span>
                    <span class="text-muted">Bids:</span> <span class="fw-bold">{{this.totalBids}}</span>
                  </div>
                  <div class="small mt-1">
                    <i class="bi bi-clock text-muted me-1"></i>
                    <span class="text-muted">Ends: {{this.endTime}}</span>
                  </div>
                </div>
                <div class="text-end">
                  {{#if this.hasQuestions}}
                  <span class="badge bg-warning mb-2">
                    <i class="bi bi-chat-dots me-1"></i>{{this.questionCount}}
                  </span>
                  {{/if}}
                  <i class="bi bi-chevron-right text-muted d-block"></i>
                </div>
              </a>
              {{else}}
              <div class="list-group-item text-center text-muted py-4 border-0">
                <i class="bi bi-inbox fs-3 d-block mb-2 opacity-50"></i>
                <small>No active auctions</small>
              </div>
              {{/each}}
            </div>
          </div>
        </div>

        <!-- Completed Auctions (With Winners) -->
        <div class="card shadow-sm mb-4 border-0">
          <div class="card-header text-white" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
            <h6 class="mb-0"><i class="bi bi-check-circle me-2"></i>Completed Auctions</h6>
          </div>
          <div class="card-body p-0">
            <div class="list-group list-group-flush">
              {{#each sellerCompletedAuctions}}
              <a href="/seller/auctions/{{this.id}}" class="list-group-item list-group-item-action d-flex align-items-center border-0 border-bottom">
                <img src="{{this.image}}" class="rounded me-3 shadow-sm" style="width:50px; height:50px; object-fit:cover;">
                <div class="flex-grow-1">
                  <div class="fw-bold small text-dark">{{this.title}}</div>
                  <div class="small mt-1">
                    <span class="text-muted">Winner:</span> <span class="fw-bold">{{this.winnerName}}</span>
                  </div>
                  <div class="text-success fw-bold small">{{this.finalBid}} VND</div>
                  {{#if this.isPaid}}
                  <span class="badge bg-success mt-1">Paid</span>
                  {{else}}
                  <span class="badge bg-warning mt-1">Pending Payment</span>
                  {{/if}}
                  {{#if this.isRated}}
                  <span class="badge bg-info mt-1">Rated</span>
                  {{/if}}
                </div>
                <div class="text-end">
                  {{#unless this.isRated}}
                  <button class="btn btn-sm btn-outline-primary mb-1" onclick="rateWinner({{this.id}})">
                    <i class="bi bi-star me-1"></i>Rate
                  </button>
                  {{/unless}}
                  <i class="bi bi-chevron-right text-muted d-block"></i>
                </div>
              </a>
              {{else}}
              <div class="list-group-item text-center text-muted py-4 border-0">
                <i class="bi bi-inbox fs-3 d-block mb-2 opacity-50"></i>
                <small>No completed auctions</small>
              </div>
              {{/each}}
            </div>
          </div>
        </div>

        <!-- Pending Questions -->
        <div class="card shadow-sm mb-4 border-0">
          <div class="card-header text-white" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
            <h6 class="mb-0"><i class="bi bi-chat-left-dots me-2"></i>Pending Questions</h6>
          </div>
          <div class="card-body p-0">
            <div class="list-group list-group-flush">
              {{#each pendingQuestions}}
              <a href="/seller/auctions/{{this.auctionId}}#questions" class="list-group-item list-group-item-action border-0 border-bottom">
                <div class="d-flex justify-content-between align-items-start mb-2">
                  <div class="fw-bold text-dark small">{{this.auctionTitle}}</div>
                  <span class="badge bg-warning">New</span>
                </div>
                <div class="small text-muted mb-1">
                  <i class="bi bi-person-circle me-1"></i>{{this.askerName}}
                  <span class="mx-2">•</span>
                  <i class="bi bi-clock me-1"></i>{{this.timeAgo}}
                </div>
                <div class="small text-dark">{{this.question}}</div>
              </a>
              {{else}}
              <div class="list-group-item text-center text-muted py-4 border-0">
                <i class="bi bi-chat-left-dots fs-3 d-block mb-2 opacity-50"></i>
                <small>No pending questions</small>
              </div>
              {{/each}}
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column: Seller Statistics -->
      <div class="col-lg-4">
        <div class="row mb-3">
          <div class="col-6 mb-3">
            <div class="card text-center shadow-sm h-100 border-0 text-white" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
              <div class="card-body p-3">
                <i class="bi bi-clock-history fs-3 mb-2 opacity-75"></i>
                <div class="small text-white-50 mb-1">Active</div>
                <h4 class="mb-0 fw-bold">{{sellerStats.activeAuctions}}</h4>
              </div>
            </div>
          </div>
          <div class="col-6 mb-3">
            <div class="card text-center shadow-sm h-100 border-0 text-white" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);">
              <div class="card-body p-3">
                <i class="bi bi-check-circle fs-3 mb-2 opacity-75"></i>
                <div class="small text-white-50 mb-1">Completed</div>
                <h4 class="mb-0 fw-bold">{{sellerStats.completedAuctions}}</h4>
              </div>
            </div>
          </div>
          <div class="col-6 mb-3">
            <div class="card text-center shadow-sm h-100 border-0 text-white" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
              <div class="card-body p-3">
                <i class="bi bi-chat-left-dots fs-3 mb-2 opacity-75"></i>
                <div class="small text-white-50 mb-1">Questions</div>
                <h4 class="mb-0 fw-bold">{{sellerStats.pendingQuestions}}</h4>
              </div>
            </div>
          </div>
          <div class="col-6 mb-3">
            <div class="card text-center shadow-sm h-100 border-0 text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
              <div class="card-body p-3">
                <i class="bi bi-currency-dollar fs-3 mb-2 opacity-75"></i>
                <div class="small text-white-50 mb-1">Total Revenue</div>
                <h4 class="mb-0 fw-bold">{{sellerStats.totalRevenue}}</h4>
                <small class="text-white-50">million</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Seller Rating -->
        <div class="card shadow-sm mb-3 border-0">
          <div class="card-header text-white" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
            <h6 class="mb-0"><i class="bi bi-star-fill me-2"></i>Seller Rating</h6>
          </div>
          <div class="card-body text-center">
            <div class="display-4 fw-bold text-primary mb-2">{{sellerRating.score}}</div>
            <div class="text-warning mb-2">
              <i class="bi bi-star-fill"></i>
              <i class="bi bi-star-fill"></i>
              <i class="bi bi-star-fill"></i>
              <i class="bi bi-star-fill"></i>
              <i class="bi bi-star-half"></i>
            </div>
            <div class="small text-muted">
              <i class="bi bi-hand-thumbs-up-fill text-success me-1"></i>
              <span class="text-success fw-bold">{{sellerRating.positive}}</span>
              <span class="mx-2">•</span>
              <i class="bi bi-hand-thumbs-down-fill text-danger me-1"></i>
              <span class="text-danger fw-bold">{{sellerRating.negative}}</span>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="card shadow-sm border-0">
          <div class="card-header text-white" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <h6 class="mb-0"><i class="bi bi-gear-fill me-2"></i>Manage</h6>
          </div>
          <div class="card-body">
            <a href="/seller/products" class="btn btn-outline-primary w-100 mb-2">
              <i class="bi bi-box-seam me-2"></i>All Products
            </a>
            <a href="/seller/transactions" class="btn btn-outline-secondary w-100">
              <i class="bi bi-receipt me-2"></i>Transactions
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .nav-tabs .nav-link {
    color: #6c757d;
    border: none;
    border-bottom: 3px solid transparent;
    font-weight: 500;
  }

  .nav-tabs .nav-link:hover {
    border-color: transparent;
    color: #667eea;
  }

  .nav-tabs .nav-link.active {
    color: #667eea;
    background: transparent;
    border-bottom-color: #667eea;
  }

  .card.text-white h4 {
    font-size: 1.6rem;
    font-weight: 700;
  }

  .card.text-white .small {
    font-size: 0.9rem;
    font-weight: 600;
  }

  .card.text-white i {
    font-size: 2rem;
    opacity: 0.85;
  }

  .card.text-white .card-body {
    padding: 1.5rem 1rem;
  }

  .list-group-item:hover {
    background-color: #f8f9fa;
  }

  .badge {
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
  }
</style>

<script>
  function rateWinner(auctionId) {
    // Handle rating modal/form
    window.location.href = `/seller/auctions/${auctionId}/rate`;
  }
</script>